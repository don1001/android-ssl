package uk.ac.cam.gpe21.droidssl.analysis;

import soot.SootClass;
import soot.SootMethod;

public final class Vulnerability {
	private final SootClass clazz;
	private final SootMethod method;
	private final VulnerabilityType type;
	private final VulnerabilityState state;

	public Vulnerability(SootClass clazz, VulnerabilityType type, VulnerabilityState state) {
		this.clazz = clazz;
		this.method = null;
		this.type = type;
		this.state = state;
	}

	public Vulnerability(SootMethod method, VulnerabilityType type, VulnerabilityState state) {
		this.clazz = method.getDeclaringClass();
		this.method = method;
		this.type = type;
		this.state = state;
	}

	public SootClass getClazz() {
		return clazz;
	}

	public SootMethod getMethod() {
		return method;
	}

	public VulnerabilityType getType() {
		return type;
	}

	public VulnerabilityState getState() {
		return state;
	}

	@Override
	public boolean equals(Object o) {
		if (this == o) return true;
		if (o == null || getClass() != o.getClass()) return false;

		Vulnerability that = (Vulnerability) o;

		if (!clazz.equals(that.clazz)) return false;
		if (method != null ? !method.equals(that.method) : that.method != null) return false;
		if (state != that.state) return false;
		if (type != that.type) return false;

		return true;
	}

	@Override
	public int hashCode() {
		int result = clazz.hashCode();
		result = 31 * result + (method != null ? method.hashCode() : 0);
		result = 31 * result + type.hashCode();
		result = 31 * result + state.hashCode();
		return result;
	}

	@Override
	public String toString() {
		if (method == null) {
			return clazz.getName() + "\t" + type + "\t" + state;
		} else {
			return clazz.getName() + "::" + method.getName() + "\t" + type + "\t" + state;
		}
	}
}
