package uk.ac.cam.gpe21.droidssl.analysis;

import soot.SootClass;
import soot.SootMethod;

public final class Vulnerability {
	private final SootClass clazz;
	private final SootMethod method;
	private final VulnerabilityType type;
	private final VulnerabilityState state;

	public Vulnerability(SootClass clazz, VulnerabilityType type, VulnerabilityState state) {
		this.clazz = clazz;
		this.method = null;
		this.type = type;
		this.state = state;
	}

	public Vulnerability(SootMethod method, VulnerabilityType type, VulnerabilityState state) {
		this.clazz = method.getDeclaringClass();
		this.method = method;
		this.type = type;
		this.state = state;
	}

	public SootClass getClazz() {
		return clazz;
	}

	public SootMethod getMethod() {
		return method;
	}

	public VulnerabilityType getType() {
		return type;
	}

	public VulnerabilityState getState() {
		return state;
	}

	@Override
	public String toString() {
		if (method == null) {
			return clazz.getName() + "\t" + type + "\t" + state;
		} else {
			return clazz.getName() + "::" + method.getName() + "\t" + type + "\t" + state;
		}
	}
}
